{"initCode":"from itertools import islice \n\ndef arrwindow(seq, n=2):\n    \"Returns a sliding window (of width n) over data from the iterable\"\n    \"   s -> (s0,s1,...s[n-1]), (s1,s2,...,sn), ...                   \"\n    it = iter(seq)\n    result = tuple(islice(it, n))\n    if len(result) == n:\n        yield result\n    for elem in it:\n        result = result[1:] + (elem,)\n        yield result","code":"@udf(returnType=ArrayType(ArrayType(StringType())))\ndef rolling_window(text:list, window_size:int):\n    if len(text) < window_size:\n        return [text]\n    else:\n        return list(arrwindow(text, n=window_size))\n    "}